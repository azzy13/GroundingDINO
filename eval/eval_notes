UserWarning: None of the inputs have requires_grad=True. Gradients will be None
[0015] saved: baseline -> outputs_compare/2025-08-11_1147/baseline/0015.txt, clip_fused -> outputs_compare/2025-08-11_1147/clip_fused/0015.txt
[0016] saved: baseline -> outputs_compare/2025-08-11_1147/baseline/0016.txt, clip_fused -> outputs_compare/2025-08-11_1147/clip_fused/0016.txt
[0018] saved: baseline -> outputs_compare/2025-08-11_1147/baseline/0018.txt, clip_fused -> outputs_compare/2025-08-11_1147/clip_fused/0018.txt
[0019] saved: baseline -> outputs_compare/2025-08-11_1147/baseline/0019.txt, clip_fused -> outputs_compare/2025-08-11_1147/clip_fused/0019.txt
[0020] saved: baseline -> outputs_compare/2025-08-11_1147/baseline/0020.txt, clip_fused -> outputs_compare/2025-08-11_1147/clip_fused/0020.txt

===== EVALUATING: BASELINE =====
      num_frames      mota      motp  ...  num_false_positives  num_misses  num_objects
0015       376.0  0.519079  0.239101  ...                323.0       463.0       1651.0
0016       209.0  0.546280  0.288871  ...                275.0      1001.0       2863.0
0018       324.0  0.775480  0.153172  ...                142.0       153.0       1354.0
0019      1059.0  0.428795  0.286216  ...               1684.0      2273.0       7015.0
0020       837.0  0.454612  0.185013  ...                263.0      2726.0       5497.0
AVG        561.0  0.544849  0.230475  ...                537.4      1323.2       3676.0

[6 rows x 15 columns]

===== EVALUATING: CLIP-FUSED =====
      num_frames      mota      motp  ...  num_false_positives  num_misses  num_objects
0015       376.0  0.408843  0.242659  ...                555.0       386.0       1651.0
0016       209.0  0.499825  0.287273  ...                518.0       891.0       2863.0
0018       332.0  0.726736  0.163297  ...                250.0       110.0       1354.0
0019      1059.0  0.310192  0.287777  ...               2722.0      2044.0       7015.0
0020       837.0  0.512643  0.213917  ...                640.0      2012.0       5497.0
AVG        562.6  0.491648  0.238985  ...                937.0      1088.6       3676.0

[6 rows x 15 columns]

===== COMPARISON (Baseline vs CLIP-Fused, with Δ = CLIP - Baseline) =====
     num_frames                      mota                           motp                           idf1                            idp                            idr                      precision  \
       Baseline CLIP-Fused    Δ  Baseline CLIP-Fused         Δ  Baseline CLIP-Fused         Δ  Baseline CLIP-Fused         Δ  Baseline CLIP-Fused         Δ  Baseline CLIP-Fused         Δ  Baseline   
0015      376.0      376.0  0.0  0.519079   0.408843 -0.110236  0.239101   0.242659  0.003558  0.709045   0.664362 -0.044683  0.741893   0.633516 -0.108376  0.678982   0.698365  0.019382  0.786234   
0016      209.0      209.0  0.0  0.546280   0.499825 -0.046455  0.288871   0.287273 -0.001598  0.689200   0.670278 -0.018922  0.806270   0.720482 -0.085789  0.601816   0.626615  0.024799  0.871315   
0018      324.0      332.0  8.0  0.775480   0.726736 -0.048744  0.153172   0.163297  0.010125  0.859473   0.832865 -0.026608  0.862993   0.793842 -0.069151  0.855982   0.875923  0.019941  0.894267   
0019     1059.0     1059.0  0.0  0.428795   0.310192 -0.118603  0.286216   0.287777  0.001561  0.601295   0.551809 -0.049486  0.628852   0.527493 -0.101359  0.576051   0.578475  0.002423  0.737940   
0020      837.0      837.0  0.0  0.454612   0.512643  0.058032  0.185013   0.213917  0.028904  0.609307   0.668260  0.058953  0.856625   0.779394 -0.077231  0.472803   0.584864  0.112061  0.913316   
AVG       561.0      562.6  1.6  0.544849   0.491648 -0.053201  0.230475   0.238985  0.008510  0.693664   0.677515 -0.016149  0.779327   0.690945 -0.088381  0.637127   0.672848  0.035721  0.840614   

                             recall                      num_switches                  mostly_tracked                  mostly_lost                  num_fragmentations                   \
     CLIP-Fused         Δ  Baseline CLIP-Fused         Δ     Baseline CLIP-Fused     Δ       Baseline CLIP-Fused     Δ    Baseline CLIP-Fused     Δ           Baseline CLIP-Fused     Δ   
0015   0.695055 -0.091179  0.719564   0.766202  0.046638          8.0       35.0  27.0            7.0        7.0   0.0         5.0        2.0  -3.0               34.0       58.0  24.0   
0016   0.791968 -0.079347  0.650367   0.688788  0.038421         23.0       23.0   0.0            6.0        6.0   0.0         2.0        1.0  -1.0               95.0      116.0  21.0   
0018   0.832664 -0.061603  0.887001   0.918759  0.031758          9.0       10.0   1.0            6.0       11.0   5.0         0.0        0.0   0.0               10.0       12.0   2.0   
0019   0.646172 -0.091768  0.675980   0.708624  0.032644         50.0       73.0  23.0           18.0       22.0   4.0         4.0        1.0  -3.0              220.0      265.0  45.0   
0020   0.844848 -0.068467  0.504093   0.633982  0.129889          9.0       27.0  18.0            8.0       23.0  15.0        37.0       19.0 -18.0               30.0      117.0  87.0   
AVG    0.762141 -0.078473  0.687401   0.743271  0.055870         19.8       33.6  13.8            9.0       13.8   4.8         9.6        4.6  -5.0               77.8      113.6  35.8   

     num_false_positives                    num_misses                   num_objects                  
                Baseline CLIP-Fused       Δ   Baseline CLIP-Fused      Δ    Baseline CLIP-Fused    Δ  
0015               323.0      555.0   232.0      463.0      386.0  -77.0      1651.0     1651.0  0.0  
0016               275.0      518.0   243.0     1001.0      891.0 -110.0      2863.0     2863.0  0.0  
0018               142.0      250.0   108.0      153.0      110.0  -43.0      1354.0     1354.0  0.0  
0019              1684.0     2722.0  1038.0     2273.0     2044.0 -229.0      7015.0     7015.0  0.0  
0020               263.0      640.0   377.0     2726.0     2012.0 -714.0      5497.0     5497.0  0.0  
AVG                537.4      937.0   399.6     1323.2     1088.6 -234.6      3676.0     3676.0  0.0  


best params
BOX_THRESHOLD   = 0.49
TEXT_THRESHOLD  = 0.20
TRACK_THRESH    = 0.18
MATCH_THRESH    = 0.85
TRACK_BUFFER    = 180
CLIP_LAMBDA_WEIGHT = 0.27
CLIP_TEXT_SIM_THRESH = 0.17 

#text sim thresh 0.0
====== AVERAGE ======
      num_frames      mota      motp      idf1  ...  num_fragmentations  num_false_positives  num_misses  num_objects
0015       376.0  0.423985  0.248869  0.668188  ...                60.0                563.0       360.0       1651.0
0016       209.0  0.515194  0.286952  0.708186  ...               115.0                504.0       867.0       2863.0
0018       332.0  0.726736  0.163987  0.836785  ...                12.0                251.0       110.0       1354.0
0019      1059.0  0.315324  0.287373  0.548490  ...               272.0               2687.0      2044.0       7015.0
0020       837.0  0.515736  0.215032  0.678994  ...               121.0                634.0      2002.0       5497.0
AVG        562.6  0.499395  0.240443  0.688129  ...               116.0                927.8      1076.6       3676.0

[6 rows x 15 columns]

#after text sim thresh 0.15

====== AVERAGE ======
      num_frames      mota      motp      idf1  ...  num_fragmentations  num_false_positives  num_misses  num_objects
0015       376.0  0.425803  0.249048  0.669332  ...                61.0                560.0       360.0       1651.0
0016       209.0  0.512050  0.286812  0.695133  ...               112.0                508.0       871.0       2863.0
0018       332.0  0.694239  0.163037  0.823936  ...                12.0                294.0       111.0       1354.0
0019      1059.0  0.313899  0.287228  0.536619  ...               271.0               2701.0      2039.0       7015.0
0020       837.0  0.517373  0.215168  0.680166  ...               121.0                631.0      1995.0       5497.0
AVG        562.6  0.492673  0.240259  0.681037  ...               115.4                938.8      1075.2       3676.0

# after adding lower passes and adding IOU+clip association

====== AVERAGE ======
      num_frames      mota      motp      idf1  ...  num_fragmentations  num_false_positives  num_misses  num_objects
0015       376.0  0.409449  0.246494  0.664940  ...                62.0                557.0       385.0       1651.0
0016       209.0  0.526720  0.286434  0.689433  ...               118.0                438.0       893.0       2863.0
0018       332.0  0.726736  0.162861  0.836785  ...                12.0                251.0       110.0       1354.0
0019      1059.0  0.319031  0.286595  0.549730  ...               271.0               2650.0      2051.0       7015.0
0020       837.0  0.517555  0.215180  0.680100  ...               121.0                629.0      1995.0       5497.0
AVG        562.6  0.499898  0.239513  0.684197  ...               116.8                905.0      1086.8       3676.0

# after the latest changes to cliptracker
====== AVERAGE ======
      num_frames      mota      motp      idf1  ...  num_fragmentations  num_false_positives  num_misses  num_objects
0015       376.0  0.397335  0.243231  0.587795  ...                50.0                578.0       406.0       1651.0
0016       209.0  0.442543  0.286268  0.523999  ...               110.0                547.0      1002.0       2863.0
0018       332.0  0.713442  0.158305  0.778519  ...                12.0                261.0       120.0       1354.0
0019      1059.0  0.283678  0.283123  0.318819  ...               261.0               2764.0      2165.0       7015.0
0020       837.0  0.510460  0.206498  0.380764  ...               117.0                643.0      2009.0       5497.0
AVG        562.6  0.469491  0.235485  0.517979  ...               110.0                958.6      1140.4       3676.0

      num_frames      mota      motp      idf1  ...  num_fragmentations  num_false_positives  num_misses  num_objects
0015       376.0  0.390672  0.241784  0.576291  ...                41.0                551.0       445.0       1651.0
0016       209.0  0.399232  0.284790  0.421093  ...                97.0                554.0      1103.0       2863.0
0018       324.0  0.719350  0.155887  0.767966  ...                11.0                232.0       143.0       1354.0
0019      1059.0  0.293229  0.285789  0.287308  ...               267.0               2680.0      2189.0       7015.0
0020       837.0  0.472258  0.206164  0.293019  ...               112.0                646.0      2214.0       5497.0
AVG        561.0  0.454948  0.234883  0.469135  ...               105.6                932.6      1218.8       3676.0

====== AVERAGE ======
      num_frames      mota      motp      idf1  ...  num_fragmentations  num_false_positives  num_misses  num_objects
0015       376.0  0.412477  0.243700  0.660334  ...                61.0                549.0       377.0       1651.0
0016       209.0  0.518337  0.286713  0.655663  ...               117.0                445.0       900.0       2863.0
0018       332.0  0.723043  0.159559  0.831871  ...                12.0                252.0       111.0       1354.0
0019      1059.0  0.315324  0.290665  0.565726  ...               281.0               2645.0      2046.0       7015.0
0020       837.0  0.511188  0.210956  0.662443  ...               121.0                625.0      1991.0       5497.0
AVG        562.6  0.496074  0.238319  0.675207  ...               118.4                903.2      1085.0       3676.0